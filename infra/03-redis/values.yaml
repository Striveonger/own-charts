# Default values for Redis.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  pullPolicy: IfNotPresent
  repository: redis
  tag: "7.0.11"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  type: ClusterIP
  redisPort: 6379
  clusterPort: 16379

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []

resources:
  limits:
    memory: 750Mi
  requests:
    memory: 256Mi

# Redis specific configuration
redis:
  password: "A123456a"
  dataDir: "/data"
  configDir: "/etc/redis"

  config:
    # Network
    protectedMode: "yes"
    port: 6379
    bind: "0.0.0.0"
    tcpBacklog: 511
    timeout: 0
    tcpKeepalive: 300

    # General
    pidfile: "/var/run/redis_6379.pid"
    loglevel: "notice"
    logfile: ""
    databases: 16
    alwaysShowLogo: "no"
    setProcTitle: "yes"
    procTitleTemplate: "{title} {listen-addr} {server-mode}"

    # Security
    acllogMaxLen: 128

    # RDB Persistence
    stopWritesOnBgsaveError: "yes"
    rdbcompression: "yes"
    rdbchecksum: "yes"
    dbfilename: "dump.rdb"
    rdbDelSyncFiles: "no"
    rdbSaveIncrementalFsync: "yes"

    # Replication
    replicaServeStaleData: "yes"
    replicaReadOnly: "yes"
    replDisklessSync: "yes"
    replDisklessSyncDelay: 5
    replDisklessSyncMaxReplicas: 0
    replDisklessLoad: "disabled"
    replDisableTcpNodelay: "no"
    replicaPriority: 100

    # Lazy Freeing
    lazyfreeLazyEviction: "no"
    lazyfreeLazyExpire: "no"
    lazyfreeLazyServerDel: "no"
    replicaLazyFlush: "no"
    lazyfreeLazyUserDel: "no"
    lazyfreeLazyUserFlush: "no"

    # OOM
    oomScoreAdj: "no"
    oomScoreAdjValues: "0 200 800"
    disableThp: "yes"

    # AOF Persistence
    appendonly: "no"
    appendfilename: "appendonly.aof"
    appenddirname: "appendonlydir"
    appendfsync: "everysec"
    noAppendfsyncOnRewrite: "no"
    autoAofRewritePercentage: 100
    autoAofRewriteMinSize: "64mb"
    aofLoadTruncated: "yes"
    aofUseRdbPreamble: "yes"
    aofTimestampEnabled: "no"
    aofRewriteIncrementalFsync: "yes"

    # Slow Log
    slowlogLogSlowerThan: 10000
    slowlogMaxLen: 128

    # Latency Monitor
    latencyMonitorThreshold: 0

    # Event Notification
    notifyKeyspaceEvents: ""

    # Data Structure Optimization
    hashMaxListpackEntries: 512
    hashMaxListpackValue: 64
    listMaxListpackSize: -2
    listCompressDepth: 0
    setMaxIntsetEntries: 512
    zsetMaxListpackEntries: 128
    zsetMaxListpackValue: 64
    hllSparseMaxBytes: 3000
    streamNodeMaxBytes: 4096
    streamNodeMaxEntries: 100

    # Advanced
    activerehashing: "yes"
    clientOutputBufferLimitNormal: "0 0 0"
    clientOutputBufferLimitReplica: "256mb 64mb 60"
    clientOutputBufferLimitPubsub: "32mb 8mb 60"
    hz: 10
    dynamicHz: "yes"
    jemallocBgThread: "yes"

    # Extra custom configuration (raw format)
    extra: ""

persistence:
  data:
    size: 2Gi
    accessMode: ReadWriteOnce

livenessProbe:
  exec:
    command:
      - redis-cli
      - ping
  initialDelaySeconds: 30
  periodSeconds: 10

readinessProbe:
  exec:
    command:
      - redis-cli
      - ping
  initialDelaySeconds: 5
  periodSeconds: 5

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80

volumes: []

volumeMounts: []

nodeSelector: {}

tolerations: []

affinity: {}
